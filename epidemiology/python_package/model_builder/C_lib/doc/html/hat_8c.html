<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>simforence-population-based: /Users/seb/websites/simforence/simforence-population-based/simforence_model_builder/templates/src/C/core/hat.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">simforence-population-based
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_382b62fd9ca97535352e87eb3043a695.html">C</a></li><li class="navelem"><a class="el" href="dir_6571d0af7a3b40c985423fd20632a65d.html">core</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hat.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;simforence.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for hat.c:</div>
<div class="dyncontent">
<div class="center"><img src="hat_8c__incl.png" border="0" usemap="#_2_users_2seb_2websites_2simforence_2simforence-population-based_2simforence__model__builder_2templates_2src_2_c_2core_2hat_8c" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6807537c2fef8ad0edc853a32e4b46e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hat_8c.html#a6807537c2fef8ad0edc853a32e4b46e8">get_CI95</a> (double *hat_95, const double *to_be_sorted, size_t *index_sorted, double *weights)</td></tr>
<tr class="separator:a6807537c2fef8ad0edc853a32e4b46e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cee9ec87aae3c9df154872df6648c9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hat_8c.html#a5cee9ec87aae3c9df154872df6648c9c">compute_hat</a> (struct <a class="el" href="structs___x.html">s_X</a> ***D_J_p_X, struct <a class="el" href="structs__par.html">s_par</a> *p_par, struct <a class="el" href="structs__data.html">s_data</a> *p_data, struct <a class="el" href="structs__calc.html">s_calc</a> **calc, struct <a class="el" href="structs__hat.html">s_hat</a> **D_p_hat, double *weights, int t0, int t1)</td></tr>
<tr class="separator:a5cee9ec87aae3c9df154872df6648c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5cee9ec87aae3c9df154872df6648c9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_hat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs___x.html">s_X</a> ***&#160;</td>
          <td class="paramname"><em>D_J_p_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs__par.html">s_par</a> *&#160;</td>
          <td class="paramname"><em>p_par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs__data.html">s_data</a> *&#160;</td>
          <td class="paramname"><em>p_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs__calc.html">s_calc</a> **&#160;</td>
          <td class="paramname"><em>calc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs__hat.html">s_hat</a> **&#160;</td>
          <td class="paramname"><em>D_p_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>t1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>compute estimation of the state variable (p_hat-&gt;state) and the observation (D_p_hat-&gt;obs). The 95% confidence interval (CI) are also computed and stored in D_p_hat-&gt;state_95 and D_p_hat-&gt;obs_95. Note that the estimations are computed by a weighted average (each value is weighted by it's likelihood value).</p>
<p>A potential issue is that when we have missing data for all the time series, we don't have the weights for these times... In this case this function assume equal weight for every particle (weight= 1.0/J) so we compute an empirical average.</p>
<p>Time indexes: ok this is pretty confusing. D_J_p_X is [N_DATA+1], D_p_hat-&gt;... are in [N_DATA] so we have to be carrefull!</p>
<p>This function should be rewritten to avoid excessive code duplication... </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hat_8c_a5cee9ec87aae3c9df154872df6648c9c_cgraph.png" border="0" usemap="#hat_8c_a5cee9ec87aae3c9df154872df6648c9c_cgraph" alt=""/></div>
<map name="hat_8c_a5cee9ec87aae3c9df154872df6648c9c_cgraph" id="hat_8c_a5cee9ec87aae3c9df154872df6648c9c_cgraph">
<area shape="rect" id="node3" href="hat_8c.html#a6807537c2fef8ad0edc853a32e4b46e8" title="get_CI95" alt="" coords="157,5,232,33"/><area shape="rect" id="node5" href="drift_8c.html#ab4f7cde349019c2f2134990fb098015c" title="drift_par" alt="" coords="160,57,230,85"/><area shape="rect" id="node7" href="observation__template_8c.html#a1d484c335972926114446d6936131756" title="obs_mean" alt="" coords="153,109,236,137"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hat_8c_a5cee9ec87aae3c9df154872df6648c9c_icgraph.png" border="0" usemap="#hat_8c_a5cee9ec87aae3c9df154872df6648c9c_icgraph" alt=""/></div>
<map name="hat_8c_a5cee9ec87aae3c9df154872df6648c9c_icgraph" id="hat_8c_a5cee9ec87aae3c9df154872df6648c9c_icgraph">
<area shape="rect" id="node3" href="smc_8c.html#aee1f9f6468ba4352b7ce10fe0edf2077" title="run_SMC" alt="" coords="169,5,247,33"/><area shape="rect" id="node13" href="smc_8c.html#aa085c397f91f5e39a59340866246f4a4" title="run_SMC_zmq" alt="" coords="153,57,263,85"/><area shape="rect" id="node5" href="smc_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="332,5,382,33"/><area shape="rect" id="node7" href="pmcmc_8h.html#a296c56b63272b17e71d6ba2e9c0da213" title="run_propag" alt="" coords="313,57,402,85"/><area shape="rect" id="node9" href="pmcmc_8h.html#a053cabb4dfa2edfbcb6deabb418b032e" title="pMCMC" alt="" coords="452,57,522,85"/><area shape="rect" id="node11" href="pmcmc_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="571,57,621,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6807537c2fef8ad0edc853a32e4b46e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_CI95 </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>hat_95</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>to_be_sorted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>index_sorted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>fill hat_95[2] with the 95% confidence interval (lower value in hat_95[0] and upper one in hat_95[1]). to_be_sorted is an array of the J particle to be sorted and weights their weights.</p>
<p>NOTE: if weights is NULL, 1.0/J will be assumed as a weight </p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hat_8c_a6807537c2fef8ad0edc853a32e4b46e8_icgraph.png" border="0" usemap="#hat_8c_a6807537c2fef8ad0edc853a32e4b46e8_icgraph" alt=""/></div>
<map name="hat_8c_a6807537c2fef8ad0edc853a32e4b46e8_icgraph" id="hat_8c_a6807537c2fef8ad0edc853a32e4b46e8_icgraph">
<area shape="rect" id="node3" href="simforence__template_8h.html#a5cee9ec87aae3c9df154872df6648c9c" title="compute_hat" alt="" coords="143,57,241,85"/><area shape="rect" id="node18" href="simulation_8h.html#a2fb563979059c88a758c934b30803496" title="compute_hat_nn" alt="" coords="132,109,252,137"/><area shape="rect" id="node5" href="smc_8c.html#aee1f9f6468ba4352b7ce10fe0edf2077" title="run_SMC" alt="" coords="319,5,396,33"/><area shape="rect" id="node15" href="smc_8c.html#aa085c397f91f5e39a59340866246f4a4" title="run_SMC_zmq" alt="" coords="302,57,412,85"/><area shape="rect" id="node7" href="smc_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="482,5,532,33"/><area shape="rect" id="node9" href="pmcmc_8h.html#a296c56b63272b17e71d6ba2e9c0da213" title="run_propag" alt="" coords="462,57,551,85"/><area shape="rect" id="node11" href="pmcmc_8h.html#a053cabb4dfa2edfbcb6deabb418b032e" title="pMCMC" alt="" coords="601,57,671,85"/><area shape="rect" id="node13" href="pmcmc_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="720,57,770,85"/><area shape="rect" id="node20" href="simulation_2main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="482,134,532,162"/><area shape="rect" id="node22" href="simulation_8h.html#ae2547c2fde1baa63e4f0e0bbd1240e21" title="traj" alt="" coords="337,161,377,189"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 11 2012 10:22:33 for simforence-population-based by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
