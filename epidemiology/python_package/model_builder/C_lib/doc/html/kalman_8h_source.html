<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>simforence-population-based: /Users/seb/websites/simforence/simforence-population-based/simforence_model_builder/templates/src/C/kalman/kalman.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">simforence-population-based
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_382b62fd9ca97535352e87eb3043a695.html">C</a></li><li class="navelem"><a class="el" href="dir_6375b99d038702886e9a111fad55c2cc.html">kalman</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">kalman.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="kalman_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *    This file is part of Simforence-population-based.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *    Simforence-population-based is free software: you can redistribute</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *    it and/or modify it under the terms of the GNU General Public</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *    License as published by the Free Software Foundation, either</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *    version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *    Simforence-population-based is distributed in the hope that it</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *    will be useful, but WITHOUT ANY WARRANTY; without even the implied</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *    warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *    See the GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *    You should have received a copy of the GNU General Public</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *    License along with Simforence-population-based.  If not, see</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *    &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *************************************************************************/</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;simforence.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pmcmc_8h.html">pmcmc.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="code" href="kalman_8h.html#a4608c90073107b5c48e72147a1bd72e9">   22</a></span>&#160;<span class="preprocessor">#define WORLD_POP 7.e9 // approx world population, used to detect divergences</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/* global variables (used in case of simplex kalman) */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="code" href="kalman_8h.html#a5e78dbd5fd0fc01ba7b98dd15e27221e">   25</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8h.html#a5e78dbd5fd0fc01ba7b98dd15e27221e">M</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="code" href="kalman_8h.html#a78ac83016b9e573e61580408604af97f">   26</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="kalman_8h.html#a78ac83016b9e573e61580408604af97f">CONVERGENCE_STOP_SIMPLEX</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// sizes</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="code" href="kalman_8h.html#af95fab06347065f07aaf68eaea10fa99">   29</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8h.html#af95fab06347065f07aaf68eaea10fa99">N_KAL</a>;  <span class="comment">// N_PAR_SV*N_CAC + N_TS + iterator_only_drift.nbtot</span></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="code" href="kalman_8h.html#a774ef5fabf258ca0f238ea69ecda7ab2">   30</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8h.html#a774ef5fabf258ca0f238ea69ecda7ab2">N_REAC</a>; <span class="comment">// number of reactions for demographic stochasticity computation</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// options</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="code" href="kalman_8h.html#a1359fa56afd609055f62cbf9b83418fb">   33</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8h.html#a1359fa56afd609055f62cbf9b83418fb">OPTION_TRANSF</a>;  <span class="comment">// add log_transf_correc to log_lik</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   To make things easier, vectors are in lower case letters, matrix in</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">   capital letters and scalar prefixed by sc_</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// method_specific_data (accessible via p_calc-&gt;method_specific_thread_safe_data) (after casting)</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html">   42</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structs__kalman__specific__data.html">s_kalman_specific_data</a></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// only ref</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#a0d110c38f84b130e9843456b7e4302b4">   46</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#a0d110c38f84b130e9843456b7e4302b4">Q</a>;  <span class="comment">/* Dispersion matrix of the SDE approximated with by the EKF: dX_t = f(X_t,\theta)dt + Chol(Q)dB_t */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#a0e25b147cf2018a27cc526f0769f890e">   47</a></span>&#160;    gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#a0e25b147cf2018a27cc526f0769f890e">Ft</a>; <span class="comment">/* Jacobian matrix of the drift f(X_t,\theta) of the SDE approximated with the EKF: dX_t = f(X_t,\theta)dt + Chol(Q)dB_t */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#af0114c59293d40bc618508f61355644a">   49</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__group.html">s_group</a> ***<a class="code" href="structs__kalman__specific__data.html#af0114c59293d40bc618508f61355644a">compo_groups_drift_par_proc</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// need to be allocated, free</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#a81ed766688af7cad5ca0b68eb63cbca8">   52</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#a81ed766688af7cad5ca0b68eb63cbca8">FtCt</a>;     <span class="comment">// for Ft*Ct</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#a4e135467c62d2741db7f29a1d2295f83">   53</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#a4e135467c62d2741db7f29a1d2295f83">res</a>;      <span class="comment">// for Ft*Ct+Ct*Ft&#39;+Q</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// for demographic stochasticity</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#a4fbd4eb93545ba7822477f913f4a9e8a">   56</a></span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="structs__kalman__specific__data.html#a4fbd4eb93545ba7822477f913f4a9e8a">F</a>;        <span class="comment">/* Vector containing transition rates of the model: as many compenents as possible reactions */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#af4a01d8b7d71a2748dc54c1c3bce88b5">   57</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#af4a01d8b7d71a2748dc54c1c3bce88b5">S</a>;    <span class="comment">/* Stoichiometric matrix containing in each column the reasult (+1 or -1 generally) of each reaction regarding each component : as many columns as reactions, as many rows as compartments*/</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#ada89e2b58f43101f658812e10b8456a1">   58</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#ada89e2b58f43101f658812e10b8456a1">SF</a>;   <span class="comment">// S*F for G computing</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="code" href="structs__kalman__specific__data.html#a339f0165f0ad82b262d2943035446989">   59</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kalman__specific__data.html#a339f0165f0ad82b262d2943035446989">G</a>;    <span class="comment">// Dispersion matrix specific to the demographic stochasticity: will be added to the global dispersion matrix Q</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;};</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="code" href="structs__kal.html">   63</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structs__kal.html">s_kal</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="code" href="structs__kal.html#a4d5963e55e60c2902e49919cad7df97d">   65</a></span>&#160;  gsl_vector *<a class="code" href="structs__kal.html#a4d5963e55e60c2902e49919cad7df97d">xk</a>;  <span class="comment">/* [N_KAL]: concatenation of non-overlapping components of X-&gt;proj, X-&gt;obs and X-&gt;drift */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="code" href="structs__kal.html#a889df1b6fba5f29086435840f260d7f9">   67</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kal.html#a889df1b6fba5f29086435840f260d7f9">Ct</a>;  <span class="comment">/* [N_KAL][N_KAL] Covariance matrix of the joint density p(X_t|y_{1:i}) if i&lt;=t&lt;i */</span> </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="code" href="structs__kal.html#a4a40b14f5bfbfad57dba235d9b8e7ada">   68</a></span>&#160;  gsl_matrix *<a class="code" href="structs__kal.html#a4a40b14f5bfbfad57dba235d9b8e7ada">Ft</a>;  <span class="comment">/* [N_KAL][N_KAL] Jacobian matrix of the drift f(X_t,\theta) of the SDE approximated with the EKF: dX_t = f(X_t,\theta)dt + Chol(Q)dB_t */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="code" href="structs__kal.html#a7cfde07f953dbe3718799adf36d21e7a">   70</a></span>&#160;  gsl_vector *<a class="code" href="structs__kal.html#a7cfde07f953dbe3718799adf36d21e7a">kt</a>;  <span class="comment">/* [N_KAL] Kalman Gain vector */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="code" href="structs__kal.html#aac607fea34e5873970dad0999d2f8796">   72</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structs__kal.html#aac607fea34e5873970dad0999d2f8796">sc_st</a> <span class="comment">/* Innovation or residuak covariance */</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="code" href="structs__kal.html#a2544dc4a1a3d19e72b7fe859275c6465">   73</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structs__kal.html#a2544dc4a1a3d19e72b7fe859275c6465">sc_pred_error</a> <span class="comment">/* Innovation or measurement residual */</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="code" href="structs__kal.html#ac1abf9de3482f7db32d4d6f399e14ff3">   74</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structs__kal.html#ac1abf9de3482f7db32d4d6f399e14ff3">sc_rt</a> <span class="comment">/* observation process variance */</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;};</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="code" href="structs__common.html">   77</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structs__common.html">s_common</a></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="structs__common.html#a344ee51dedd41f8bbf9b53e2538f8cef">   79</a></span>&#160;  gsl_matrix *<a class="code" href="structs__common.html#a344ee51dedd41f8bbf9b53e2538f8cef">Q</a>; <span class="comment">/* [N_KAL][N_KAL] */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="structs__common.html#ad3b81e4436d0f63e7f667e0ace915bed">   80</a></span>&#160;  gsl_vector *<a class="code" href="structs__common.html#ad3b81e4436d0f63e7f667e0ace915bed">ht</a>; <span class="comment">/* [N_KAL] Gradient of the observation function */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="code" href="structs__kalman.html">   83</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structs__kalman.html">s_kalman</a></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">/* from simforence core */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">   86</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="code" href="structs__kalman.html#af2bfff3bea17e6054a4728b067aad2ff">   87</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__calc.html">s_calc</a> **<a class="code" href="structs__kalman.html#af2bfff3bea17e6054a4728b067aad2ff">calc</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="code" href="structs__kalman.html#a63ba0aa4c4d054baa63d9bae12d3836b">   88</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__best.html">s_best</a> *<a class="code" href="structs__kalman.html#a63ba0aa4c4d054baa63d9bae12d3836b">p_best</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">   89</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="structs__kalman.html#a1219973dd765ee61f6c073de8f083ba7">   90</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs___x.html">s_X</a> *<a class="code" href="structs__kalman.html#a1219973dd765ee61f6c073de8f083ba7">p_X</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="code" href="structs__kalman.html#ae8eb055a1ddd01f4c07542016bedfd9b">   92</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structs__kalman.html#ae8eb055a1ddd01f4c07542016bedfd9b">smallest_log_like</a>; <span class="comment">/* used in simplex kalman (see simplex.h) */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">/* kalman specific */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="code" href="structs__kalman.html#aeaeb97e1fea34c0eaa9380cc84ed5bed">   95</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__kal.html">s_kal</a> *<a class="code" href="structs__kalman.html#aeaeb97e1fea34c0eaa9380cc84ed5bed">p_kal</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="code" href="structs__kalman.html#abf097afd5939cfac268a27e02906e193">   96</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__common.html">s_common</a> *<a class="code" href="structs__kalman.html#abf097afd5939cfac268a27e02906e193">p_common</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="structs__kalman.html#a79807c7796fc5e5291df782a9f22930b">   98</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__group.html">s_group</a> ***<a class="code" href="structs__kalman.html#a79807c7796fc5e5291df782a9f22930b">compo_groups_drift_par_proc</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;};</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/* build.c */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">struct </span><a class="code" href="structs__kal.html">s_kal</a> *<a class="code" href="kalman_2build_8c.html#a24431e84bd33b3e6324230e8dbe0d571">build_kal</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_2build_8c.html#a3c4b2312e6de589c57978b9912619d00">clean_kal</a>(<span class="keyword">struct</span> <a class="code" href="structs__kal.html">s_kal</a> *p_kal);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">struct </span><a class="code" href="structs__common.html">s_common</a> *<a class="code" href="kalman_2build_8c.html#af153fd83e9b293755e1f042b6ee86cc1">build_common</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_2build_8c.html#a6a425788e95ac366df2c25019004617a">clean_common</a>(<span class="keyword">struct</span> <a class="code" href="structs__common.html">s_common</a> *p_common);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">struct </span><a class="code" href="structs__kalman.html">s_kalman</a> *<a class="code" href="kalman_2build_8c.html#adb9726388da0d34edab6db35ec17582d">build_kalman</a>(json_t *root, <span class="keywordtype">int</span> is_bayesian);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_2build_8c.html#a436f31c7ded07599212feb2ae9b1dbf0">clean_kalman</a>(<span class="keyword">struct</span> <a class="code" href="structs__kalman.html">s_kalman</a> *p_kalman);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/* kalman.c */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">double</span> <a class="code" href="kalman_8c.html#a5380c92e14bb079aa318516ccb39b95d">run_kalman</a>(<span class="keyword">struct</span> <a class="code" href="structs___x.html">s_X</a> *<a class="code" href="structs__kalman.html#a1219973dd765ee61f6c073de8f083ba7">p_X</a>, <span class="keyword">struct</span> <a class="code" href="structs__best.html">s_best</a> *<a class="code" href="structs__kalman.html#a63ba0aa4c4d054baa63d9bae12d3836b">p_best</a>, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__kal.html">s_kal</a> *<a class="code" href="structs__kalman.html#aeaeb97e1fea34c0eaa9380cc84ed5bed">p_kal</a>, <span class="keyword">struct</span> <a class="code" href="structs__common.html">s_common</a> *<a class="code" href="structs__kalman.html#abf097afd5939cfac268a27e02906e193">p_common</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>, <span class="keyword">struct</span> <a class="code" href="structs__calc.html">s_calc</a> **<a class="code" href="structs__kalman.html#af2bfff3bea17e6054a4728b067aad2ff">calc</a>, FILE *p_file_X, <span class="keywordtype">int</span> m);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">double</span> <a class="code" href="kalman_8h.html#ab9d851a5cef109a6e42ad6395869e442">f_simplex_kalman</a>(<span class="keyword">const</span> gsl_vector *x, <span class="keywordtype">void</span> *params);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_8c.html#afb1683985ac2283649d0647844895ccc">reset_kalman</a>(<span class="keyword">struct</span> <a class="code" href="structs__kal.html">s_kal</a> *<a class="code" href="structs__kalman.html#aeaeb97e1fea34c0eaa9380cc84ed5bed">p_kal</a>, <span class="keyword">struct</span> <a class="code" href="structs__common.html">s_common</a> *<a class="code" href="structs__kalman.html#abf097afd5939cfac268a27e02906e193">p_common</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_8c.html#a06eb51db1b41ba9aeabc445317191274">xk2X</a>(<span class="keyword">struct</span> <a class="code" href="structs___x.html">s_X</a> *<a class="code" href="structs__kalman.html#a1219973dd765ee61f6c073de8f083ba7">p_X</a>, gsl_vector *xk, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_8c.html#af00c5602b1b8d5bc28d8828e142e16ee">X2xk</a>(gsl_vector *xk, <span class="keyword">struct</span> <a class="code" href="structs___x.html">s_X</a> *<a class="code" href="structs__kalman.html#a1219973dd765ee61f6c073de8f083ba7">p_X</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8c.html#a47dc09b2cb93e227a3e84098009067da">list2sym_matrix</a>(gsl_matrix *mat, <span class="keywordtype">double</span> *vect, <span class="keywordtype">int</span> offset);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8c.html#a3235a778317211452fc7427c696d374d">sym_matrix2list</a>(<span class="keywordtype">double</span> *vect, gsl_matrix *mat, <span class="keywordtype">int</span> offset);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_8c.html#a728fdc223be5e9398d2afe5f31292d24">find_cell_from_vector_form</a>(<span class="keywordtype">int</span> *cell, <span class="keywordtype">int</span> idx);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8c.html#aae5202a6636406547141ed4e9d684cfe">find_cell_from_matrix_form</a>(<span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8c.html#ad3ddf4ce9c662e93402258bda995a6ae">matrix_times_list_form</a>(gsl_matrix *res, gsl_matrix *mat, <span class="keyword">const</span> <span class="keywordtype">double</span> *vect, <span class="keywordtype">int</span> offset);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">double</span> <a class="code" href="kalman_8c.html#a23b28ea481cae1d578570e23e6a28b24">get_total_pop</a>(<span class="keywordtype">double</span> *X);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordtype">double</span> <a class="code" href="kalman_8c.html#aafe1260824909011fbcd54e56912e3dc">log_transf_correc</a>(gsl_vector *mean, gsl_matrix *var, <span class="keyword">struct</span> <a class="code" href="structs__router.html">s_router</a> **routers);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/* ekf.c */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ekf_8c.html#a7a585fde2278383a27463577aeb448e9">reset_inc_Cov</a>(gsl_matrix *Ct);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ekf_8c.html#a0c6cad8522d93a76632e3353e34135ae">check_and_correct_Ct</a>(gsl_matrix *Ct);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_8h.html#a708be090eaa3f9b9d76899a109f86b4f">ekf_propag_cov</a>(<span class="keywordtype">double</span> *proj, gsl_matrix *Ft, gsl_matrix *Ct, gsl_matrix *Q, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__group.html">s_group</a> ***<a class="code" href="structs__kalman.html#a79807c7796fc5e5291df782a9f22930b">compo_groups_drift_par_proc</a>, <span class="keywordtype">double</span> t);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ekf_8c.html#a0a390c67da64aa9d589478c50f444952">ekf_gain_computation</a>(<span class="keywordtype">double</span> xk_t_ts, <span class="keywordtype">double</span> data_t_ts, gsl_matrix *Ct, gsl_vector *ht, gsl_vector *kt, <span class="keywordtype">double</span> sc_rt, <span class="keywordtype">double</span> *sc_st, <span class="keywordtype">double</span> *sc_pred_error);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">double</span> <a class="code" href="ekf_8c.html#a64afbbb87ee76c7fbc6f791d7feece57">ekf_update</a>(gsl_vector *xk, gsl_matrix *Ct, gsl_vector *ht, gsl_vector *kt, <span class="keywordtype">double</span> sc_st, <span class="keywordtype">double</span> sc_pred_error);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/* eval_ekf_update_mats */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">int</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#acc60a832dbe1cf4608e6494d948a49c5">cac_drift_in_cac_ts</a>(<span class="keywordtype">int</span> cac_drift, <span class="keywordtype">int</span> o, <span class="keywordtype">int</span> ts_unique, <span class="keyword">struct</span> <a class="code" href="structs__obs2ts.html">s_obs2ts</a> **obs2ts);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">void</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#a9d4ce30f822f4ad7916029a84416a545">eval_jac</a>(gsl_matrix *<a class="code" href="simforence__template_8h.html#adb7ef85e081151c7f2f7eab58bf62617">jac</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> *X, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>, <span class="keyword">struct</span> <a class="code" href="structs__calc.html">s_calc</a> *p_calc, <span class="keyword">struct</span> <a class="code" href="structs__group.html">s_group</a> ***<a class="code" href="structs__kalman.html#a79807c7796fc5e5291df782a9f22930b">compo_groups_drift_par_proc</a>, <span class="keywordtype">double</span> t);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">void</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#ae4428d8bf181de9f8caf93fc8e842305">eval_ht</a>(gsl_vector *ht, gsl_vector *xk, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>, <span class="keyword">struct</span> <a class="code" href="structs__calc.html">s_calc</a> *p_calc, <span class="keywordtype">int</span> ts);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">void</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#a67daa1e07767b9c1b612713155359223">eval_F</a>(<span class="keywordtype">double</span> *F, <span class="keyword">const</span> <span class="keywordtype">double</span> *X, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>, <span class="keyword">struct</span> <a class="code" href="structs__calc.html">s_calc</a> *p_calc, <span class="keyword">struct</span> <a class="code" href="structs__group.html">s_group</a> ***<a class="code" href="structs__kalman.html#a79807c7796fc5e5291df782a9f22930b">compo_groups_drift_par_proc</a>, <span class="keywordtype">double</span> t);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">void</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#a9cc5151a892cc786eee38a8f47f1d1bd">eval_Q</a>(gsl_matrix *Q, <span class="keyword">const</span> <span class="keywordtype">double</span> *proj, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>, <span class="keyword">struct</span> <a class="code" href="structs__calc.html">s_calc</a> *p_calc, <span class="keyword">struct</span> <a class="code" href="structs__kalman__specific__data.html">s_kalman_specific_data</a> *p_kalman_specific_data, <span class="keywordtype">double</span> t);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">int</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#adbdc2f330ae2b8854cb28a12508df724">eval_G</a>(gsl_matrix *G, <span class="keyword">const</span> <span class="keywordtype">double</span> *X, <span class="keyword">struct</span> <a class="code" href="structs__par.html">s_par</a> *<a class="code" href="structs__kalman.html#a3778342886d2654aa76bdc4914dac540">p_par</a>, <span class="keyword">struct</span> <a class="code" href="structs__data.html">s_data</a> *<a class="code" href="structs__kalman.html#a4eff7eec23cd78ed898f02bd8e95397e">p_data</a>, <span class="keyword">struct</span> <a class="code" href="structs__calc.html">s_calc</a> *p_calc, <span class="keyword">struct</span> <a class="code" href="structs__kalman__specific__data.html">s_kalman_specific_data</a> *p_kalman_specific_data, <span class="keywordtype">double</span> t);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordtype">int</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#a357863747eb11a55ed44a51f1273ceea">init_REAC</a>(<span class="keyword">struct</span> <a class="code" href="structs__obs2ts.html">s_obs2ts</a> **obs2ts);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">void</span> <a class="code" href="eval__ekf__update__mats__template_8c.html#aa5c8229c17743e9f09ffe001af804a5c">eval_S</a>(gsl_matrix *S, <span class="keyword">struct</span> <a class="code" href="structs__obs2ts.html">s_obs2ts</a> **obs2ts);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/* prediction.c */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">int</span> <a class="code" href="kalman_8h.html#a13f3d94cd947d45bcf5899598c96d5bc">func_kal</a>(<span class="keywordtype">double</span> t, <span class="keyword">const</span> <span class="keywordtype">double</span> X[], <span class="keywordtype">double</span> f[], <span class="keywordtype">void</span> *params);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">/* kmcmc.c */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">void</span> <a class="code" href="kalman_8h.html#a8cb5c14f1653139f957ee74ad7c1890b">kmcmc</a>(<span class="keyword">struct</span> <a class="code" href="structs__kalman.html">s_kalman</a> *p_kalman, <span class="keyword">struct</span> <a class="code" href="structs__likelihood.html">s_likelihood</a> *p_like, <span class="keyword">struct</span> <a class="code" href="structs__pmcmc__calc__data.html">s_pmcmc_calc_data</a> *p_pmcmc_calc_data);</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Nov 11 2012 10:22:32 for simforence-population-based by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
